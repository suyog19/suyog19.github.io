<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin System Test - सुविचार साथी</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Admin System Test</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>API Endpoints Test</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary mb-2" onclick="testAdminLogin()">Test Admin Login</button><br>
                        <button class="btn btn-info mb-2" onclick="testDashboardStats()">Test Dashboard Stats</button><br>
                        <button class="btn btn-success mb-2" onclick="testUsersList()">Test Users List</button><br>
                        <button class="btn btn-warning mb-2" onclick="testQuotesList()">Test Quotes List</button><br>
                        
                        <div id="testResults" class="mt-3">
                            <h6>Results:</h6>
                            <pre id="results" class="bg-light p-2" style="max-height: 300px; overflow-y: auto;"></pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Quick Links</h5>
                    </div>
                    <div class="card-body">
                        <a href="admin-login.html" class="btn btn-outline-primary btn-block mb-2 d-block">Go to Admin Login</a>
                        <a href="admin-dashboard.html" class="btn btn-outline-success btn-block mb-2 d-block">Go to Admin Dashboard</a>
                        <a href="suvicharsathi.html" class="btn btn-outline-info btn-block d-block">Back to Main Site</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://cuddly-spork-xqvpg9w4xh6pxr-8000.app.github.dev';
        const resultsDiv = document.getElementById('results');
        
        function log(message) {
            resultsDiv.textContent += new Date().toLocaleTimeString() + ': ' + message + '\n';
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }
        
        async function testAdminLogin() {
            log('Testing admin login endpoint...');
            try {
                const response = await fetch(`${API_BASE_URL}/admin/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        username: 'testadmin',
                        password: 'testpass'
                    })
                });
                
                log(`Admin login response: ${response.status} ${response.statusText}`);
                const data = await response.json();
                log(`Admin login data: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`Admin login error: ${error.message}`);
            }
        }
        
        async function testDashboardStats() {
            log('Testing dashboard stats endpoint...');
            const token = localStorage.getItem('adminToken');
            
            if (!token) {
                log('No admin token found. Please login first.');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/dashboard`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                log(`Dashboard stats response: ${response.status} ${response.statusText}`);
                const data = await response.json();
                log(`Dashboard stats data: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`Dashboard stats error: ${error.message}`);
            }
        }
        
        async function testUsersList() {
            log('Testing users list endpoint...');
            const token = localStorage.getItem('adminToken');
            
            if (!token) {
                log('No admin token found. Please login first.');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/users?page=1&size=5`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                log(`Users list response: ${response.status} ${response.statusText}`);
                const data = await response.json();
                log(`Users list data: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`Users list error: ${error.message}`);
            }
        }
        
        async function testQuotesList() {
            log('Testing quotes list endpoint...');
            const token = localStorage.getItem('adminToken');
            
            if (!token) {
                log('No admin token found. Please login first.');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/quotes?page=1&size=5`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                log(`Quotes list response: ${response.status} ${response.statusText}`);
                const data = await response.json();
                log(`Quotes list data: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`Quotes list error: ${error.message}`);
            }
        }
        
        // Clear results
        function clearResults() {
            resultsDiv.textContent = '';
        }
        
        log('Admin system test page loaded.');
        log('API Base URL: ' + API_BASE_URL);
        log('Current admin token: ' + (localStorage.getItem('adminToken') ? 'Present' : 'Not found'));
    </script>
</body>
</html>
